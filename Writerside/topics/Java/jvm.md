# jvm

## 堆和栈的区别
JVM是基于堆栈的虚拟机.JVM为每个新创建的线程都分配一个堆栈.也就是说,对于一个Java程序来说，它的运行就是通过对堆栈的操作来完成的。堆栈以帧为单位保存线程的状态。JVM对堆栈只进行两种操作:以帧为单位的压栈和出栈操作。       

`差异:`
1. 堆内存用来存放由new创建的对象和数组。
2. 栈内存用来存放方法或者局部变量等
3. 堆是先进先出，后进后出
4. 栈是后进先出，先进后出

`相同:`
1. 都是属于Java内存的一种 
2. 系统都会自动去回收它，但是对于堆内存一般开发人员会自动回收它

## 堆和栈的区别
Java中的内存分为两种，堆内存和栈内存
1. 栈内存  
   在函数当中定义的基本类型变量和对象引用变量，java都会给它分配栈内存。一旦离开作用域，这些内存都会被释放掉。
   在函数当中的代码块当中定义的变量，java也会给它分配栈空间。

2. 堆内存  
   在java当中使用new关键字创建的内存是在堆上分配的，这些内存是由java虚拟机的垃圾回收器来自动管理的。在栈中可以定义特殊的引用变量指向在堆内存中分配的对象或者数组的首地址，通过这些引用变量来操作堆内存。当没有引用指向这些堆中的内存的时候，这些内存就变为了不可访问的内存，也就是变为了垃圾，但是此时并不会被回收。GC垃圾回收器，会在一个不确定的时间将这些垃圾进行回收。

## Java中堆和栈的比较 {id="java_1"}
1. 首先在Java中程序员都不可以直接操作堆和栈
2. new创建的对象存在于堆中，局部变量存在于栈中。在堆中定义的对象会在栈中存其的首地址，方便快速访问。
3. 栈的存取方式为先进后出，堆为先进先出
4. 栈的访问速度快于堆
5. 栈的生命周期一般短，用完即释放。堆相对较长，用完不一定释放，由操作系统的内存回收机制决定

## 怎么获取 Java 程序使用的内存？堆使用的百分比？
可以通过java.lang.Runtime 类中与内存相关方法来获取剩余的内存，总内存及最大堆内存。通过这些方法你也可以获取到堆使用的百分比及堆内存的剩余空间。Runtime.freeMemory() 方法返回剩余空间的字节数，Runtime.totalMemory() 方法总内存的字节数，Runtime.maxMemory() 返回最大内存的字节数。
