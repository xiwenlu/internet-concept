# 面试技巧

## 如果项目中有异常该怎么处理？业务逻辑层能不能捕获异常？
首先需要明确一个理念：异常是抛给程序员的，而不是抛给用户的。      
明确了这个理念之后就好理解了，为什么需要在表现层处理异常——因为表现层是程序员和用户之间的最后一道屏障，必须把异常包装得漂漂亮亮的丢给客户，也就是所谓的用户体验。        
然而，表现层绝对不是唯一要处理异常的地方，你所说的那些地方，包括底层、服务器……都需要适当的处理异常。      
比如说，服务端提供的接口，一般要考虑调用者的体验，所以不会直接抛异常出来，而是需要进行一定的封装，同时在服务端记录异常信息以便查错。        
当然为了简化和统一处理过程，通常会集中在某些层次，包括表现层对异常进行处理。        
应该在service层定义好异常情况，遇到问题时抛出异常（RuntimeException），然后再表现层根据异常种类做出相应的动作。这样就是view层依赖于serivce层，而service层可以为更多种view层提供服务了。但是这样也有一些问题，就是如果serivce逻辑复杂，可能异常种类就非常多，这样项目做起来也很麻烦。      
异常不要用来做流程控制，条件控制，因为异常的处理效率比条件分支低。        
对大段代码进行try-catch，这是不负责任的表现。catch时请分清稳定代码和非稳定代码，稳定代码指的是无论如何不会出错的代码。对于非稳定代码的catch尽可能进行区分异常类型，再做对应的异常处理。        
捕获异常是为了处理它，不要捕获了却什么都不处理而抛弃之，如果不想处理它，请将该异常抛给它的调用者。最外层的业务使用者，必须处理异常，将其转化为用户可以理解的内容。      
有try块放到了事务代码中，catch异常后，如果需要回滚事务，一定要注意手动回滚事务。    
finally块必须对资源对象、流对象进行关闭，有异常也要做try-catch。说明：如果JDK7，可以使用try-with-resources方式。        
不能在finally块中使用return，finally块中的return返回后方法结束执行，不会再执行try块中的return语句。     
捕获异常与抛异常，必须是完全匹配，或者捕获异常是抛异常的父类。说明：如果预期对方抛的是绣球，实际接到的是铅球，就会产生意外情况。        
方法的返回值可以为null，不强制返回空集合，或者空对象等，必须添加注释充分说明什么情况下会返回null值。调用方需要进行null判断防止NPE问题。     
说明：本规约明确防止NPE是调用者的责任。即使被调用方法返回空集合或者空对象，对调用者来说，也并非高枕无忧，必须考虑到远程调用失败，运行时异常等场景返回null的情况。      
在代码中使用“抛异常”还是“返回错误码”，对于公司外的http/api开放接口必须使用“错误码”；而应用内部推荐异常抛出；跨应用间RPC调用优先考虑使用Result方式，封装isSuccess、“错误码”、“错误简短信息”。              
定义时区分unchecked/checked异常，避免直接使用RuntimeException抛出，更不允许抛出Exception或者Throwable，应使用有业务含义的自定义异常。推荐业界已定义过的自定义异常，如：DAOException/ServiceException等。     
对于运行时异常，我们不要用try...catch来捕获处理，而是在程序开发调试阶段，尽量去避免这种异常，一旦发现该异常，正确的做法就会改进程序设计的代码和实现方式，修改程序中的错误，从而避免这种异常。捕获并处理运行时异常是好的解决办法，因为可以通过改进代码实现来避免该种异常的发生。对于受检查异常，没说的，老老实实去按照异常处理的方法去处理，要么用try...catch捕获并解决，要么用throws抛出！对于Error（运行时错误），不需要在程序中做任何处理，出现问题后，应该在程序在外的地方找问题，然后解决。


## 自我介绍常见模板 3个？
1. 商品管理模块的开发，这个模块包含:商品管理，商品分类管理，商品参数管理，商品属性管理，规格管理，品牌管理；

在数据库中涉及到的表有产品表，产品图片表，品牌表，分类表，产品参数组表，产品参数表，产品参数值表等。        
通常先在商品分类管理模块中建立产品的分类，该分类是一个树形表结构，我通过全部取出数据并对取出的数据进行递归算法生成树形结构的数据，并将其数据渲染为具有层次嵌套关系的下拉列表以及表格控件从而在页面进行使用，因为在后台的很多地方都使用到分类信息，而分类信息又不容易发生变化，所以我就结合oscache将分类信息进行缓存，并封装到BaseController中，从而方便在其他Controller中直接调用该方法。      
建立分类后可以在商品参数管理模块中建立和指定分类绑定的参数组以及参数信息，之后在添加产品时就可以选择产品所属的分类然后就会出现和该分类绑定的参数组以及参数信息供公司内部业务人员填写，保存后将参数信息保存到参数值表中，普通用户可以在 产品详情页 的 商品参数 中找到。        
规格管理，属性管理的操作流程和上述流程类似。
1. 统计分析模块：

统计模块由会员统计，店铺统计，销量统计等构成，其中会员统计可以按天、周、月通过echarts的折线图对新增的会员进行统计分析，通过echarts的饼状图对会员所在区域进行统计，并且可以根据会员的下单量，下单商品件数，下单金额分别进行统计分析计算出买家排行top10,并支持将这会员信息通过poi导出excel结合javamail发送到指定人的邮箱中。      

## 你们这个月做的什么项目。用了几张表，分别列出。用到了什么技术，并介绍下用它的好处，并介绍至少3个以上，模块。1000字。

我们做的是一个电商项目,用了40张表,用到了poi  hicharts  bootStrap ,maven管理项目,多模块开发 duboo+zookper,ngingx+tomcat,主从同步+读写分离,springBoot 框架,solr搜索引擎,redis缓存级服务.        

我着重介绍提下duboo+zookeeper,nigingx+tomcat  和主从同步+读写分离吧,Duboo呢 是2012年阿里巴巴开发的开源的分布式框架,可以实现项目模块之间的拆分部署,dubbo分为生产者和消费者,生产者和消费者之间采用的是长连接来进行关联的,dubbo是基于tcp/ip协议的,交互性能高,支持匿名传参,影视传参,泛化调用(影视传参是指以括号的形式传参,将参数存到存储到当前请求里面,到了服务端再从请求里面拿出来,request不能传参.泛化调用是指用一个service接口和是个service实现类来实现多个方法的调用)我们当时这个项目页面+控制层作为消费者,service+dao作为生产者,生产者和消费者之间用zookeeper进行调度.     

zookeerper用来完成生产者的接口在zookeerper里面的注册，当一个生产者挂掉的同时，zookeerper会把当前请求分发给别的生产者。当新的生产者启动的时候，zookeerper也会给新的生产者分发任务。zookeerper也可以实现集群。     

dubbo是把项目实现分离，分为消费端跟服务端，在消费者这边的配置文件中添上zookeeper地址，让它连上zookeeper，每个服务端都暴露一个端口给zookeeper，这样就实现服务端在zookeeper中注册，消费者发送请求给zookeeper，zookeeper接收请求，zookeeper再分发给这些服务端。    

`nigingx+tomcat:`
一般来讲 nginx ＋ tomcat 是做成负载均衡架构,nginx 负责负载分发 tomcat 负责请求的处理,这样可以成倍的增加系统处理能力       
通常的代理服务器，只用于代理内部网络对Internet的连接请求，客户机必须指定代理服务器,并将本来要直接发送到Web服务器上的http请求发送到代理服务器中由代理服务器向Internet上的web服务器发起请求，最终达到客户机上网的目的。        
而反向代理（Reverse Proxy）方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。如下图所示：

<img src="tomcat.jpeg" alt=""/>

反向代理方式实际上就是一台负责转发的代理服务器，貌似充当了真正服务器的功能，但实际上并不是，代理服务器只是充当了转发的作用，并且从真正的服务器那里取得返回的数据。这样说，其实nginx完成的就是这样的工作。我们让nginx监听一端口，譬如80端口，但实际上我们转发给在8080端口的tomcat，由它来处理真正的请求，当请求完成后，tomcat返回，但数据此时没直接返回，而是直接给nginx，由nginx进行返回，这里，我们会以为是nginx进行了处理，但实际上进行处理的是tomcat。       

`主从同步+读写分离`     
当时我们这个数据库访问压力过大，做了个主从同步，用了两个mysql数据库，       
所有的更新走主库，所有的查询走从库。主库，从库之间通过日志进行同步，首先主库设置一个用户，给出所有权限，获取主库的服务id和日志属性值，将主库的server id 和日志属性id添加到从库的my.cnf文件里面，当主库产生sql日志或操作日志，从库跟主库保持一致。        
读写分离简单的说是把对数据库读和写的操作分开对应不同的数据库服务器，这样能有效地减轻数据库压力，也能减轻io压力。主数据库提供写操作，从数据库提 供读操作，其实在很多系统中，主要是读的操作      
1. 增加冗余
2. 增加了机器的处理能力
3. 对于读操作为主的应用，使用读写分离是最好的场景，因为可以确保写的服务器压力更小，而读又可以接受点时间上的延迟。



## 列出你的这个月做的报表，都展示的是什么。并写出sql。
我这个月主要负责迪蒙网贷这个项目的统计管理一模块，这个模块中我用到了highcharts报表去展示统计数据，因为他们更直观的去表达一些信息，而且跨语言跨平台支持多种浏览器，数据灵活，支持xml 和json。我主要用它展示的是一些关于用户统计、资金统计和业务统计。其中       

1. 用户统计中又细分为        
平台用户数据统计：主要统计一些用户通过什么渠道注册和注册的数量，以及某一时间段累计注册的趋势图。        
平台在线用户统计：统计用户在哪一天的哪些时间段在线数量的折线图。        
平台用户属性统计：通过饼状图统计平台用户的一些基本信息，比如性别占比，以及年龄比例等。     
2. 资金统计又细分为     
资金统计总览：用柱形图去展示些个人、机构、平台的资金流动等信息。        
风险保证金统计：通过折线图去展示年度、季度的风险保证金。        
充值提现数据统计：用区域图的形式将一年中每个月的充值提现笔数数据和充值提现金额数据展示给我们。     
3. 业务统计细分为      
成交数据统计：将年度公司总成交金额数据通过折线图展现出来。               
逾期数据统计：将平台用户逾期金额数和逾期时间以及次数整合并通过散点图展示出来。     
业务员业绩统计：将内部员工的每个月每个季度的业绩信息通过折线图展现给公司领导层。        
业务员业绩明细：通过普通的表格去展示公司内部员工业绩的具体信息等。       

信息数据一般都是通过多表之间的关联去查询出来了具体实例代码如下（其中一例）
```sql
select userinfo.user_id,userinfo.user_name,dep.dep_name,sex.sex_name from userinfo,dep,sex 
where userinfo.user_dep=dep.dep_id and userinfo.user_sex=sex.sex_id
group by dep.dep_name
```



[comment]: <> (## 项目中都遇见过什么问题，你是如何解决的。（基本所有公司都问 2条以上 500字 5元）.)

